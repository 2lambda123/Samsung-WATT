 /*
 * Copyright (c) 2017 Samsung Electronics Co., Ltd All Rights Reserved
 *
 *    Licensed under the Apache License, Version 2.0 (the "License");
 *    you may not use this file except in compliance with the License.
 *    You may obtain a copy of the License at
 *
 *        http://www.apache.org/licenses/LICENSE-2.0
 *
 *    Unless required by applicable law or agreed to in writing, software
 *    distributed under the License is distributed on an "AS IS" BASIS,
 *    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *    See the License for the specific language governing permissions and
 *    limitations under the License.
 */
var TEST=false;function __onOCFDeviceCallback(devices){var func=window.scplugin.manager.getDeviceDetailFunc;try{var deviceList=window.scplugin._getOCFDevices(JSON.parse(devices));if(func!==null){if(typeof func==="function"){func(deviceList)}else if(typeof func==="string"){eval(func+"(deviceList)")}}}catch(e){console.log(e.name+" "+e.message)}}function __onNMOCFDeviceCallback(json){var result=JSON.parse(json);var f=undefined;if(result.result!="SUCCESS"){f=window.scplugin._scPluginNative.getErrorCallback(result);if(f){setTimeout(function(){try{f(new _APIError("NotSupportedError","This feature is not supported on Service plugin."))}catch(e){console.error(e)}},0);return}}if(f==undefined){f=window.scplugin._scPluginNative.getCallback(result)}if(f){setTimeout(function(){try{var deviceList=window.scplugin._getOCFDevices(result.devices);f(deviceList)}catch(e){console.error(e)}},0)}}function __onNMRepresentCallback(json){var result=JSON.parse(json);var f=window.scplugin._scPluginNative.getCallback(result);if(f){setTimeout(function(){try{f(result.result,result.id,result.uri,result.representation)}catch(e){console.error(e)}},0)}}function __onNMStateCallback(json){var result=JSON.parse(json);var f=window.scplugin._scPluginNative.getCallback(result);if(f){setTimeout(function(){try{f(result.state)}catch(e){console.error(e)}},0)}}function __onNMMonitoringStateCallback(json){var result=JSON.parse(json);var f=window.scplugin._scPluginNative.getCallback(result);if(f){setTimeout(function(){try{f(result.result,result.id,result.state)}catch(e){console.error(e)}},0)}}function __onNMPluginDataCallback(json){var result=JSON.parse(json);var f=window.scplugin._scPluginNative.getCallback(result);if(f){setTimeout(function(){try{f(result.key,result.value)}catch(e){console.error(e)}},0)}}function __onNMSAAuthCodeCallback(json){var result=JSON.parse(json);var f=window.scplugin._scPluginNative.getCallback(result);if(f){setTimeout(function(){try{f(result.status,result.authCode,result.authUrl,result.apiUrl,result.state)}catch(e){console.error(e)}},0)}}function __onNMServiceCallback(json){var result=JSON.parse(json);var f=undefined;if(result.result!="SUCCESS"){f=window.scplugin._scPluginNative.getErrorCallback(result);if(f){setTimeout(function(){try{f(new _APIError("NotSupportedError","This feature is not supported on Device plugin."))}catch(e){console.error(e)}},0);return}}if(f==undefined){f=window.scplugin._scPluginNative.getCallback(result)}if(f){setTimeout(function(){try{var serviceObj=window.scplugin._getService(result);f(serviceObj)}catch(e){console.error(e)}},0)}}function __onNMServiceEventCallback(json){var result=JSON.parse(json);var f=window.scplugin._scPluginNative.getCallback(result);if(f){setTimeout(function(){try{f(result.result,result.event)}catch(e){console.error(e)}},0)}}function __onNMServiceResponseCallback(json){var result=JSON.parse(json);var f=window.scplugin._scPluginNative.getCallback(result);if(f){setTimeout(function(){try{f(result.result,result.response)}catch(e){console.error(e)}},0)}}function __onNMServiceConfigurationCallback(json){var result=JSON.parse(json);var f=window.scplugin._scPluginNative.getCallback(result);if(f){setTimeout(function(){try{f(result.result)}catch(e){console.error(e)}},0)}}function __onNMProdIsApplicationInstalledCallback(json){var result=JSON.parse(json);var f=undefined;if(result.result!="SUCCESS"){f=window.scplugin._scPluginNative.getErrorCallback(result);if(f){setTimeout(function(){try{var err;if(result.result="SECURITY_ERR"){err=new _APIError("SecurityError","This plugin does not have the permission to call this method.")}else if(result="NOT_SUPPORTED_ERR"){err=new _APIError("NotSupportedError","This feature is not supported on this plugin.")}else{err=new _APIError("UnknownError","Unknown error")}f(err)}catch(e){console.error(e)}},0);return}}if(f==undefined){f=window.scplugin._scPluginNative.getCallback(result)}if(f){setTimeout(function(){try{f(result.appNameType,result.state)}catch(e){console.error(e)}},0)}}function __onNMProdLaunchApplicationCallback(json){var result=JSON.parse(json);var f=undefined;if(result.result!="SUCCESS"){f=window.scplugin._scPluginNative.getErrorCallback(result);if(f){setTimeout(function(){try{var err;if(result.result="SECURITY_ERR"){err=new _APIError("SecurityError","This plugin does not have the permission to call this method.")}else if(result="NOT_SUPPORTED_ERR"){err=new _APIError("NotSupportedError","This feature is not supported on this plugin.")}else{err=new _APIError("UnknownError","Unknown error")}f(err)}catch(e){console.error(e)}},0);return}}if(f==undefined){f=window.scplugin._scPluginNative.getCallback(result)}if(f){setTimeout(function(){try{f(result.appLinkType)}catch(e){console.error(e)}},0)}}function __onNMProdLaunchPluginCallback(json){var result=JSON.parse(json);var f=undefined;if(result.result!="SUCCESS"){f=window.scplugin._scPluginNative.getErrorCallback(result);if(f){setTimeout(function(){try{var err;if(result.result="SECURITY_ERR"){err=new _APIError("SecurityError","This plugin does not have the permission to call this method.")}else if(result="NOT_SUPPORTED_ERR"){err=new _APIError("NotSupportedError","This feature is not supported on this plugin.")}else{err=new _APIError("UnknownError","Unknown error")}f(err)}catch(e){console.error(e)}},0);return}}if(f==undefined){f=window.scplugin._scPluginNative.getCallback(result)}if(f){setTimeout(function(){try{f(result.deviceId)}catch(e){console.error(e)}},0)}}function __onNMProdLocationNicknameCallback(json){var result=JSON.parse(json);var f=undefined;if(result.result!="SUCCESS"){f=window.scplugin._scPluginNative.getErrorCallback(result);if(f){setTimeout(function(){try{var err;if(result.result="SECURITY_ERR"){err=new _APIError("SecurityError","This plugin does not have the permission to call this method.")}else if(result="NOT_SUPPORTED_ERR"){err=new _APIError("NotSupportedError","This feature is not supported on this plugin.")}else{err=new _APIError("UnknownError","Unknown error")}f(err)}catch(e){console.error(e)}},0);return}}if(f==undefined){f=window.scplugin._scPluginNative.getCallback(result)}if(f){setTimeout(function(){try{f(result.locationNickname)}catch(e){console.error(e)}},0)}}function __onNMProdAnalyticsLogInsert(json){var result=JSON.parse(json);var f=undefined;if(result.result!="SUCCESS"){f=window.scplugin._scPluginNative.getErrorCallback(result);if(f){setTimeout(function(){try{var err;if(result.result="SECURITY_ERR"){err=new _APIError("SecurityError","This plugin does not have the permission to call this method.")}else if(result="NOT_SUPPORTED_ERR"){err=new _APIError("NotSupportedError","This feature is not supported on this plugin.")}else{err=new _APIError("UnknownError","Unknown error")}f(err)}catch(e){console.error(e)}},0);return}}}function __onNMServiceShareTextCallback(json){var result=JSON.parse(json);var f=undefined;if(result.result!="SUCCESS"){f=window.scplugin._scPluginNative.getErrorCallback(result);if(f){setTimeout(function(){try{var err;if(result.result="SECURITY_ERR"){err=new _APIError("SecurityError","This plugin does not have the permission to call this method.")}else if(result="NOT_SUPPORTED_ERR"){err=new _APIError("NotSupportedError","This feature is not supported on this plugin.")}else{err=new _APIError("UnknownError","Unknown error")}f(err)}catch(e){console.error(e)}},0);return}}if(f==undefined){f=window.scplugin._scPluginNative.getCallback(result)}if(f){setTimeout(function(){try{f()}catch(e){console.error(e)}},0)}}(function(window,document,undefined){var isPlatform={Android:function(){return navigator.userAgent.match(/Android/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Tizen:function(){return navigator.userAgent.match(/Tizen/i)},Simulator:function(){return navigator.userAgent.match(/Simulator/i)},any:function(){return isPlatform.Android()||isPlatform.iOS()||isPlatform.Tizen()}};var NativeManager=function(){this.CALLBACK_ID_KEY="callbackId";this.LISTENER_ID_KEY="listenerId";var _replyId=0;this._callbacks={};this._listeners={};Object.defineProperties(this,{nextReplyId:{get:function(){return++_replyId},enumerable:false}})};NativeManager.prototype={call:function(cmd,args,callback,onerror){args=args||{};var replyId=this.nextReplyId;args[this.CALLBACK_ID_KEY]=replyId;this._callbacks[replyId]=callback;if(onerror){this._callbacks[replyId+"err"]=onerror}this.callNative(cmd,args)},addListener:function(cmd,name,args,callback){args=args||{};args[this.LISTENER_ID_KEY]=name;this._listeners[name]=callback;this.callNative(cmd,args)},removeListener:function(cmd,name,args){args=args||{};if(this._listeners.hasOwnProperty(name)){delete this._listeners[name]}this.callNative(cmd,args)},callNative:function(cmd,args){args=args||{};if(isPlatform.iOS()){window.webkit.messageHandlers[cmd].postMessage(args)}else if(isPlatform.Android()||isPlatform.Simulator()){if(Object.keys(args).length==0){eval("SC_PLUGIN."+cmd+"()")}else{eval("SC_PLUGIN."+cmd+".apply(SC_PLUGIN,[JSON.stringify(args)])")}}else if(isPlatform.Tizen()){eval(cmd+".postMessage(args)")}else{console.log("Not supported platform "+navigator.userAgent)}},getCallback:function(result){var id;if(result.hasOwnProperty(this.CALLBACK_ID_KEY)){id=result[this.CALLBACK_ID_KEY];if(typeof this._callbacks[id]!=="function"){console.error("Wrong callback identifier. Ignoring message.");return null}var f=this._callbacks[id];delete this._callbacks[id];return f}if(result.hasOwnProperty(this.LISTENER_ID_KEY)){id=result[this.LISTENER_ID_KEY];if(typeof this._listeners[id]!=="function"){console.error("Wrong callback identifier. Ignoring message.");return null}var f=this._listeners[id];return f}},getErrorCallback:function(result){var id;if(result.hasOwnProperty(this.CALLBACK_ID_KEY)){id=result[this.CALLBACK_ID_KEY]+"err";if(typeof this._callbacks[id]!=="function"){console.error("Wrong callback identifier. Ignoring message.");return null}var f=this._callbacks[id];delete this._callbacks[id];return f}}};var manager=function(){this.getDeviceDetailFunc=null};manager.prototype={setCloudConnectionStateListener:function(callback){var cmd="scpluginSetCloudConnectionStateListener";var args={};args.callbackName="__onNMStateCallback";args.cmd=cmd;try{window.scplugin._scPluginNative.addListener(cmd,cmd,args,callback)}catch(e){}},setApplicationStateListener:function(callback){var cmd="scpluginSetChangeApplicationStateListener";var args={};args.callbackName="__onNMStateCallback";args.cmd=cmd;try{window.scplugin._scPluginNative.addListener(cmd,cmd,args,callback)}catch(e){}},getOCFDevices:function(onsuccess,onerror){if(TEST){this.getDeviceDetailFunc=onsuccess;var info=JSON.stringify(window.deviceInfo);__onOCFDeviceCallback("["+info+"]")}else{var cmd="scpluginGetOCFDevices";var args={};args.callbackName="__onNMOCFDeviceCallback";args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,onsuccess,onerror)}catch(e){var err=new _APIError("NotSupportedError","This feature is not supported on Service plugin.");onerror(err)}}},getService:function(onsuccess,onerror){var cmd="scpluginGetService";var args={};args.callbackName="__onNMServiceCallback";args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,onsuccess,onerror)}catch(e){var err=new _APIError("NotSupportedError","This feature is not supported on Device plugin.");onerror(err)}},getPluginData:function(handle,key,callback){var cmd="scpluginGetPluginData";var args={};args.id=handle;args.callbackName="__onNMPluginDataCallback";args.key=key;args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,callback)}catch(e){}},setPluginData:function(handle,key,value){var cmd="scpluginSetPluginData";var args={};args.id=handle;args.key=key;args.value=value;args.cmd=cmd;try{window.scplugin._scPluginNative.callNative(cmd,args)}catch(e){}},deletePluginData:function(handle,key){var cmd="scpluginDeletePluginData";var args={};args.id=handle;args.key=key;args.cmd=cmd;try{window.scplugin._scPluginNative.callNative(cmd,args)}catch(e){}},getSAAuthCode:function(clientId,codeVerifier,state,callback,scope,duid){var cmd="scpluginGetSAAuthCode";var args={};args.clientId=clientId;args.codeVerifier=codeVerifier;args.state=state;args.scope=scope;args.duid=duid;args.callbackName="__onNMSAAuthCodeCallback";args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,callback)}catch(e){}},close:function(){var cmd="scpluginClose";try{window.scplugin._scPluginNative.callNative(cmd)}catch(e){}},launchApplication:function(appLinkType,onsuccess,onerror){var cmd="scpluginProdLaunchApplication";var args={};args.callbackName="__onNMProdLaunchApplicationCallback";args.appLinkType=appLinkType;args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,onsuccess,onerror)}catch(e){var err=new _APIError("NotSupportedError","This feature is not supported on this plugin.");onerror(err)}},isApplicationInstalled:function(appNameType,onsuccess,onerror){var cmd="scpluginProdIsApplicationInstalled";var args={};args.callbackName="__onNMProdIsApplicationInstalledCallback";args.appNameType=appNameType;args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,onsuccess,onerror)}catch(e){var err=new _APIError("NotSupportedError","This feature is not supported.");onerror(err)}}};var log=function(){};log.prototype={debug:function(className,functionName,msg){var cmd="scpluginDebugLog";var args={};args.className=className;args.functionName=functionName;args.msg=msg;args.cmd=cmd;try{window.scplugin._scPluginNative.callNative(cmd,args)}catch(e){}},error:function(className,functionName,msg){var cmd="scpluginErrorLog";var args={};args.className=className;args.functionName=functionName;args.msg=msg;args.cmd=cmd;try{window.scplugin._scPluginNative.callNative(cmd,args)}catch(e){}},info:function(className,functionName,msg){var cmd="scpluginInfoLog";var args={};args.className=className;args.functionName=functionName;args.msg=msg;args.cmd=cmd;try{window.scplugin._scPluginNative.callNative(cmd,args)}catch(e){}},verbose:function(className,functionName,msg){var cmd="scpluginVerboseLog";var args={};args.className=className;args.functionName=functionName;args.msg=msg;args.cmd=cmd;try{window.scplugin._scPluginNative.callNative(cmd,args)}catch(e){}},warning:function(className,functionName,msg){var cmd="scpluginWarningLog";var args={};args.className=className;args.functionName=functionName;args.msg=msg;args.cmd=cmd;try{window.scplugin._scPluginNative.callNative(cmd,args)}catch(e){}}};var AnalyticsLog=function(){};AnalyticsLog.prototype={insert:function(screenId,event,detail,onerror){var cmd="scpluginProdAnalyticsLogInsert";var args={};args.callbackName="__onNMProdAnalyticsLogInsert";args.screenId=screenId;args.event=event;args.detail=detail;args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,null,onerror)}catch(e){var err=new _APIError("NotSupportedError","This feature is not supported.");onerror(err)}}};var Service=function(args){Object.defineProperties(this,{serviceHandle:{value:args.serviceHandle,writable:false,enumerable:true},extraData:{value:args.extraData,writable:false,enumerable:true}})};Service.prototype={subscribe:function(callback){var cmd="scpluginServiceSubscribe";var args={};args.id=this.serviceHandle;args.callbackName="__onNMServiceEventCallback";args.cmd=cmd;try{window.scplugin._scPluginNative.addListener(cmd,cmd+this.serviceHandle,args,callback)}catch(e){}},unsubscribe:function(){var cmd="scpluginServiceUnsubscribe";var args={};args.id=this.serviceHandle;args.cmd=cmd;try{window.scplugin._scPluginNative.removeListener(cmd,"scpluginServiceSubscribe"+this.serviceHandle,args)}catch(e){}},sendRequest:function(payload,callback){var cmd="scpluginServiceExecution";var args={};args.id=this.serviceHandle;args.payload=payload;args.callbackName="__onNMServiceResponseCallback";args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,callback)}catch(e){}},launchConfiguration:function(callback){var cmd="scpluginServiceLaunchConfiguration";var args={};args.id=this.serviceHandle;args.callbackName="__onNMServiceConfigurationCallback";args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,callback)}catch(e){}},launchDevicePlugin:function(deviceId,onsuccess,onerror,extraData){var cmd="scpluginProdLaunchDevicePlugin";var args={};args.callbackName="__onNMProdLaunchPluginCallback";args.deviceId=deviceId;args.extraData=extraData;args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,onsuccess,onerror)}catch(e){var err=new _APIError("NotSupportedError","This feature is not supported.");onerror(err)}},getLocationNickname:function(onsuccess,onerror){var cmd="scpluginProdGetLocationNickname";var args={};args.callbackName="__onNMProdLocationNicknameCallback";args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,onsuccess,onerror)}catch(e){var err=new _APIError("NotSupportedError","This feature is not supported.");onerror(err)}},shareText:function(text,onsuccess,onerror){var cmd="scpluginServiceShareText";var args={};args.callbackName="__onNMServiceShareTextCallback";args.cmd=cmd;args.text=text;try{window.scplugin._scPluginNative.call(cmd,args,onsuccess,onerror)}catch(e){var err=new _APIError("NotSupportedError","This feature is not supported.");onerror(err)}}};var OCFDevice=function(args){Object.defineProperties(this,{deviceHandle:{value:args.deviceHandle,writable:false,enumerable:true},deviceType:{value:args.deviceType,writable:false,enumerable:true},deviceName:{value:args.deviceName,writable:false,enumerable:true},resourceUris:{value:args.resourceUris,writable:false,enumerable:true},locationId:{value:args.locationId,writable:false,enumerable:true},locationName:{value:args.locationName,writable:false,enumerable:true},owner:{value:args.owner,writable:false,enumerable:true},firmwareVersion:{value:args.firmwareVersion,writable:false,enumerable:true},metaData:{value:args.metaData,writable:false,enumerable:true},extraData:{value:args.extraData,writable:false,enumerable:true}})};OCFDevice.prototype={subscribe:function(callback,uris){var cmd="scpluginSubscribe";var args={};args.id=this.deviceHandle;args.callbackName="__onNMRepresentCallback";args.uris=uris;args.cmd=cmd;try{window.scplugin._scPluginNative.addListener(cmd,cmd+this.deviceHandle,args,callback)}catch(e){}},unsubscribe:function(){var cmd="scpluginUnsubscribe";var args={};args.id=this.deviceHandle;args.cmd=cmd;try{window.scplugin._scPluginNative.removeListener(cmd,"scpluginSubscribe"+this.deviceHandle,args)}catch(e){}},getRemoteRepresentation:function(uri,callback){var cmd="scpluginGetRemoteRepresentation";var args={};args.id=this.deviceHandle;args.callbackName="__onNMRepresentCallback";args.uri=uri;args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,callback)}catch(e){}},setRemoteRepresentation:function(uri,jsonObject,callback){var cmd="scpluginSetRemoteRepresentation";var args={};args.id=this.deviceHandle;args.callbackName="__onNMRepresentCallback";args.uri=uri;args.rcsRepJson=jsonObject;args.cmd=cmd;try{window.scplugin._scPluginNative.call(cmd,args,callback)}catch(e){}},startMonitoringConnectionState:function(callback){var cmd="scpluginStartMonitoringConnectionState";var args={};args.id=this.deviceHandle;args.callbackName="__onNMMonitoringStateCallback";args.cmd=cmd;try{window.scplugin._scPluginNative.addListener(cmd,cmd+this.deviceHandle,args,callback)}catch(e){}},stopMonitoringConnectionState:function(){var cmd="scpluginStopMonitoringConnectionState";var args={};args.id=this.deviceHandle;args.cmd=cmd;try{window.scplugin._scPluginNative.removeListener(cmd,"scpluginStartMonitoringConnectionState"+this.deviceHandle,args)}catch(e){}}};var _APIError=function(name,message){var _name=0;var _message="Unknown error";if(name){_name=name}if(message){_message=message}Object.defineProperties(this,{name:{value:_name,writable:false,enumerable:true},message:{value:_message,writable:false,enumerable:true}});return this};_APIError.prototype=new Error;_APIError.prototype.constructor=_APIError;var _scplugin=function(){this.manager=new manager;this.log=new log;this._scPluginNative=new NativeManager;this._APIError=new _APIError;this.analyticsLog=new AnalyticsLog};_scplugin.prototype._getOCFDevices=function(devices){var deviceList=new Array;for(var i in devices){deviceList.push(new OCFDevice(devices[i]))}return deviceList};_scplugin.prototype._getService=function(service){return new Service(service)};window.scplugin=new _scplugin})(window,document);
